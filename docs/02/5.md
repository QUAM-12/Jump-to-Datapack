# 02-5 함수의 지연

- 일반적인 스코어보드를 이용해 지연을 적용하는 것은 이곳에서 다루지 않습니다.

<br/>

프로그래밍 언어에서 `sleep`, `wait` 기능을 담당하며, `Queue` 자료구조와 유사합니다.

이와 비슷한 기능을 하는 명령어로는 `schedule`이 있습니다.

인게임에서 특정 시간이 지난 뒤에 함수를 실행하는 명령어입니다.

일정 시간마다 동작하는 시스템을 구현하는 데 쓰일 수 있습니다.

```mcfunction
schedule function test:a 20
```

<br/>

함수의 경로 뒤에 올 수 있는 시간의 단위는 틱으로 `20s`, `20d`처럼 `초/일`로 설정할 수 있습니다.

```mcfunction
test:a
   say 지연된 메시지
```

<br/>

   <video width="640" height="360" controls>
      <source src="assets/vid/02-5/schedule.mp4" type="video/mp4">
   </video> 

[[02-4 재귀함수](02/4)] 페이지에서처럼 일정 시간마다 자신을 불러올 수 있습니다.

```mcfunction
test:a
   say 1초
   schedule function test:a 20
```

<br/>

   <video width="640" height="360" controls>
      <source src="assets/vid/02-5/schedule_this.mp4" type="video/mp4">
   </video> 

[[02-2 함수의 load와 tick](02-2)] 페이지의 `tick.json`처럼 `1`틱마다 불러올 수도 있습니다.

```mcfunction
test:a
   say 1틱
   schedule function test:a 1
```

<br/>

   <video width="640" height="360" controls>
      <source src="assets/vid/02-5/schedule_tick.mp4" type="video/mp4">
   </video> 

예약을 중지하려면 [[02-4 재귀함수](02-4)]처럼 함수 실행에 조건을 추가할 수도 있지만,

`schedule clear` 명령어로 중지할 수 있습니다.

```mcfunction
schedule clear test:a
```

<br/>

   <video width="640" height="360" controls>
      <source src="assets/vid/02-5/schedule_clear.mp4" type="video/mp4">
   </video> 

다만, 주의점이 한 가지 있습니다.

원래 함수는 함수 실행자와 위치, 시선 등을 기억합니다.

```mcfunction
test:a
   say @s
   function test:b
   
test:b
   particle flame ^ ^1 ^1

>>> [User] [User]
>>> 시선 한 칸 앞 + 한 칸 위에 flame 입자 표시
```

<br/>

   <video width="640" height="360" controls>
      <source src="assets/vid/02-5/function_keep.mp4" type="video/mp4">
   </video> 

그런데 `schedule`은 함수의 실행자, 위치, 시선 등을 기억하지 않습니다.

```mcfunction
test:a
   say @s
   schedule function test:b 1t

test:b
   particle flame ^ ^1 ^1

>>> [Server]
>>> 기본적으로 함수 context(실행 대상, 위치, 시선, 차원 등의 맥락)가 없으면,
차원은 오버월드로, 위치는 0.0 0.0 0.0, 시선은 0.0 0.0, 실행자는 Server로, 엔티티는 null로 설정합니다.
```

<br/>

   <video width="640" height="360" controls>
      <source src="assets/vid/02-5/schedule_keep.mp4" type="video/mp4">
   </video> 